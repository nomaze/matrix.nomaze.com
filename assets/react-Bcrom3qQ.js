import{R as A}from"./index-CJdWDDc7.js";import{M as O,C as P}from"./mixin-DwWcv35a.js";import{H as f}from"./hls-Dund6eWy.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"6f8cb3b486a7f50e19c7f080d2e94023f23a6098"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},h=new e.Error().stack;h&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[h]="8dd7fa77-9662-4624-99a8-111cdd662e18",e._sentryDebugIdIdentifier="sentry-dbid-8dd7fa77-9662-4624-99a8-111cdd662e18")})()}catch{}const x=e=>class extends e{static shadowRootOptions={...e.shadowRootOptions};static getTemplateHTML=(t,s={})=>{const{src:v,...y}=t;return`
        <script type="application/json" id="config">
          ${JSON.stringify(s.config||{})}
        <\/script>
        ${e.getTemplateHTML(y)}
      `};#e=null;#t=null;constructor(){super(),this.#o("config")}get config(){return this.#t}set config(t){this.#t=t}attributeChangedCallback(t,s,v){t!=="src"&&super.attributeChangedCallback(t,s,v),t==="src"&&s!=v&&this.load()}#n(){var t,s;(t=this.#e)==null||t.remove(),(s=this.nativeEl)==null||s.removeEventListener("webkitcurrentplaybacktargetiswirelesschanged",this.#i),this.api&&(this.api.detachMedia(),this.api.destroy(),this.api=null)}async load(){var t,s;const v=!this.api;if(this.#n(),!!this.src){if(v&&!this.#t&&(this.#t=JSON.parse(((t=this.shadowRoot.getElementById("config"))==null?void 0:t.textContent)||"{}")),f.isSupported()){switch(await Promise.resolve(),this.api=new f({liveDurationInfinity:!0,autoStartLoad:!1,...this.config}),this.api.loadSource(this.src),this.api.attachMedia(this.nativeEl),this.nativeEl.preload){case"none":{const r=()=>this.api.startLoad();this.nativeEl.addEventListener("play",r,{once:!0}),this.api.on(f.Events.DESTROYING,()=>{this.nativeEl.removeEventListener("play",r)});break}case"metadata":{const r=this.api.config.maxBufferLength,o=this.api.config.maxBufferSize;this.api.config.maxBufferLength=1,this.api.config.maxBufferSize=1;const i=()=>{this.api.config.maxBufferLength=r,this.api.config.maxBufferSize=o};this.nativeEl.addEventListener("play",i,{once:!0}),this.api.on(f.Events.DESTROYING,()=>{this.nativeEl.removeEventListener("play",i)}),this.api.startLoad();break}default:this.api.startLoad()}this.nativeEl.webkitCurrentPlaybackTargetIsWireless&&this.api.stopLoad(),this.nativeEl.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",this.#i),this.#e=document.createElement("source"),this.#e.setAttribute("type","application/x-mpegURL"),this.#e.setAttribute("src",this.src),this.nativeEl.disableRemotePlayback=!1,this.nativeEl.append(this.#e);const y=new WeakMap;this.api.on(f.Events.MANIFEST_PARSED,(r,o)=>{this.nativeEl.autoplay&&this.nativeEl.paused&&this.nativeEl.play().catch(d=>{console.warn("Autoplay failed:",d)}),b();let i=this.videoTracks.getTrackById("main");i||(i=this.addVideoTrack("main"),i.id="main",i.selected=!0);for(const[d,l]of o.levels.entries()){const u=i.addRendition(l.url[0],l.width,l.height,l.videoCodec,l.bitrate);y.set(l,`${d}`),u.id=`${d}`}for(let[d,l]of o.audioTracks.entries()){const u=l.default?"main":"alternative",T=this.addAudioTrack(u,l.name,l.lang);T.id=`${d}`,l.default&&(T.enabled=!0)}}),this.audioTracks.addEventListener("change",()=>{var r;const o=+((r=[...this.audioTracks].find(d=>d.enabled))==null?void 0:r.id),i=this.api.audioTracks.map(d=>d.id);o!=this.api.audioTrack&&i.includes(o)&&(this.api.audioTrack=o)}),this.api.on(f.Events.LEVELS_UPDATED,(r,o)=>{const i=this.videoTracks[this.videoTracks.selectedIndex??0];if(!i)return;const d=o.levels.map(l=>y.get(l));for(const l of this.videoRenditions)l.id&&!d.includes(l.id)&&i.removeRendition(l)});let E=null;this.api.on(f.Events.ERROR,(r,o)=>{o.type===f.ErrorTypes.NETWORK_ERROR&&o.details===f.ErrorDetails.FRAG_LOAD_ERROR&&(E=o.frag.level)}),this.api.on(f.Events.LEVEL_SWITCHED,(r,o)=>{const i=o.level;E!==null&&i<E&&(console.warn(`⚠️ hls.js downgraded quality from level ${E} to ${i} due to fragment load failure.`),this.videoRenditions.selectedIndex=i,E=null)});const w=r=>{const o=r.target.selectedIndex;o!=this.api.nextLevel&&(this.api.nextLevel=o)};(s=this.videoRenditions)==null||s.addEventListener("change",w);const b=()=>{for(const r of this.videoTracks)this.removeVideoTrack(r);for(const r of this.audioTracks)this.removeAudioTrack(r)};this.api.once(f.Events.DESTROYING,b);return}await Promise.resolve(),this.nativeEl.canPlayType("application/vnd.apple.mpegurl")&&(this.nativeEl.src=this.src)}}#i=()=>{var t,s,v;(t=this.nativeEl)!=null&&t.webkitCurrentPlaybackTargetIsWireless?(s=this.api)==null||s.stopLoad():(v=this.api)==null||v.startLoad()};#o(t){if(Object.prototype.hasOwnProperty.call(this,t)){const s=this[t];delete this[t],this[t]=s}}},S=x(O(P));globalThis.customElements&&!globalThis.customElements.get("hls-video")&&globalThis.customElements.define("hls-video",S);var H=S,D=new Set(["style","children","ref","key","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML"]),N={className:"class",htmlFor:"for"};function M(e){return e.toLowerCase()}function _(e){if(typeof e=="boolean")return e?"":void 0;if(typeof e!="function"&&!(typeof e=="object"&&e!==null))return e}function C({react:e,tagName:h,elementClass:t,events:s,displayName:v,defaultProps:y,toAttributeName:E=M,toAttributeValue:w=_}){const b=Number.parseInt(e.version)>=19,r=e.forwardRef((o,i)=>{var d,l;const u=e.useRef(null),T=e.useRef(new Map),L={},R={},p={},k={};for(const[n,a]of Object.entries(o)){if(D.has(n)){p[n]=a;continue}const c=E(N[n]??n);if(t.prototype&&n in t.prototype&&!(n in(((d=globalThis.HTMLElement)==null?void 0:d.prototype)??{}))&&!((l=t.observedAttributes)!=null&&l.some(m=>m===c))){k[n]=a;continue}if(n.startsWith("on")){L[n]=a;continue}const g=w(a);if(c&&g!=null&&(R[c]=String(g),b||(p[c]=g)),c&&b){const m=_(a);g!==m?p[c]=g:p[c]=a}}if(typeof window<"u"){for(const n in L){const a=L[n],c=n.endsWith("Capture"),g=(s?.[n]??n.slice(2).toLowerCase()).slice(0,c?-7:void 0);e.useLayoutEffect(()=>{const m=u?.current;if(!(!m||typeof a!="function"))return m.addEventListener(g,a,c),()=>{m.removeEventListener(g,a,c)}},[u?.current,a])}e.useLayoutEffect(()=>{if(u.current===null)return;const n=new Map;for(const a in k)I(u.current,a,k[a]),T.current.delete(a),n.set(a,k[a]);for(const[a,c]of T.current)I(u.current,a,void 0);T.current=n})}if(typeof window>"u"&&t?.getTemplateHTML&&t?.shadowRootOptions){const{mode:n,delegatesFocus:a}=t.shadowRootOptions,c=e.createElement("template",{shadowrootmode:n,shadowrootdelegatesfocus:a,dangerouslySetInnerHTML:{__html:t.getTemplateHTML(R,o)},key:"ce-la-react-ssr-template-shadow-root"});p.children=[c,p.children]}return e.createElement(h,{...y,...p,ref:e.useCallback(n=>{u.current=n,typeof i=="function"?i(n):i!==null&&(i.current=n)},[i])},p.children)});return r.displayName=v??t.name,r}function I(e,h,t){var s;e[h]=t,t==null&&h in(((s=globalThis.HTMLElement)==null?void 0:s.prototype)??{})&&e.removeAttribute(h)}var j=C({react:A,tagName:"hls-video",elementClass:H,toAttributeName(e){return e==="muted"?"":e==="defaultMuted"?"muted":M(e)}});export{j as default};
//# sourceMappingURL=react-Bcrom3qQ.js.map
