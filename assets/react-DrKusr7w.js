import{_ as D,R as N}from"./index-mkplNe_8.js";import{M as A,C as S}from"./mixin-DM2C0SEW.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"90315d6e0d6b2abdb3ab66843a1559057a72e940"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new t.Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="1f0c98fb-ce85-4c91-8cd8-e5bf992bef92",t._sentryDebugIdIdentifier="sentry-dbid-1f0c98fb-ce85-4c91-8cd8-e5bf992bef92")})()}catch{}class I extends A(S){static shadowRootOptions={...S.shadowRootOptions};static getTemplateHTML=e=>{const{src:n,...o}=e;return S.getTemplateHTML(o)};#t;attributeChangedCallback(e,n,o){e!=="src"&&super.attributeChangedCallback(e,n,o),e==="src"&&n!=o&&this.load()}async _initThumbnails(e){const n=async(u,h)=>{const p=[],g=e.timescale||1,f=e.startNumber||1,w=e.presentationTimeOffset?e.presentationTimeOffset/g:0,_=e.segmentDuration;for(let l=0;l<u;l++){const T=C({thIndex:l,thduration:h,ttiles:u,tduration:_,startNumber:f,pto:w}),E=T+h,R=new Promise((m,y)=>{this.api.provideThumbnail(T,({url:a,width:s,height:c,x:b,y:v})=>{try{const M=new VTTCue(T,E,`${a}#xywh=${b},${v},${s},${c}`);m(M)}catch(M){y(M)}})});p.push(R)}return await Promise.all(p).catch(l=>console.error("Error processing thumbnails",l))},{totalThumbnails:o,thumbnailDuration:i}=$(e),d=await n(o,i);let r=this.nativeEl.querySelector('track[label="thumbnails"]');if(!r){r=O(),this.nativeEl.appendChild(r);const u=x(d);r.src=u,r.dispatchEvent(new Event("change"))}}async load(){if(this.#t){this.api.attachSource(this.src);return}this.#t=!0;const e=await D(()=>import("./dash.all.min-NwzadqtY.js"),[]);this.api=e.MediaPlayer().create(),this.api.initialize(this.nativeEl,this.src,this.autoplay),this.api.on(e.MediaPlayer.events.STREAM_INITIALIZED,()=>{const n=this.api.getRepresentationsByType("video");let o=this.videoTracks.getTrackById("main");o||(o=this.addVideoTrack("main"),o.id="main",o.selected=!0),n.forEach(i=>{const d=i.bandwidth??i.bitrate??(Number.isFinite(i.bitrateInKbit)?i.bitrateInKbit*1e3:void 0),r=o.addRendition(i.id,i.width,i.height,i.mimeType??i.codec,d);r.id=i.id}),this.videoRenditions.addEventListener("change",()=>{const i=this.videoRenditions[this.videoRenditions.selectedIndex];i?.id?(this.api.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!1}}}}),this.api.setRepresentationForTypeById("video",i.id,!0)):this.api.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!0}}}})}),this.api.isDynamic()||this.api.getRepresentationsByType("image").forEach(async(d,r)=>{r>0||this._initThumbnails(d)})})}}function $(t){var e,n;const o=t.essentialProperties[0],[i,d]=o.value.split("x").map(Number),r=i*d,u=((n=(e=t.adaptation)==null?void 0:e.period)==null?void 0:n.duration)||null,h=t.segmentDuration,p=t.timescale||1,f=h/p/r;return{totalThumbnails:u!=null?Math.ceil(u/f):Math.ceil(h/f),thumbnailDuration:f}}function C({thIndex:t,tduration:e,thduration:n,ttiles:o,startNumber:i,pto:d}){const r=Math.floor(t/o)+i,u=t%o+1,h=(r-1)*e-d,p=(u-1)*n;return h+p}function O(){const t=document.createElement("track");return t.kind="metadata",t.label="thumbnails",t.srclang="en",t.mode="hidden",t.default=!0,t}function x(t){let e=`WEBVTT

`;for(const i of t)e+=`${o(i.startTime)} --> ${o(i.endTime)}
`,e+=`${i.text}

`;const n=new Blob([e],{type:"text/vtt"});return URL.createObjectURL(n);function o(i){const d=String(Math.floor(i/3600)).padStart(2,"0"),r=String(Math.floor(i%3600/60)).padStart(2,"0"),u=(i%60).toFixed(3).padStart(6,"0");return`${d}:${r}:${u}`}}globalThis.customElements&&!globalThis.customElements.get("dash-video")&&globalThis.customElements.define("dash-video",I);var B=I,H=new Set(["style","children","ref","key","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML"]),F={className:"class",htmlFor:"for"};function P(t){return t.toLowerCase()}function k(t){if(typeof t=="boolean")return t?"":void 0;if(typeof t!="function"&&!(typeof t=="object"&&t!==null))return t}function W({react:t,tagName:e,elementClass:n,events:o,displayName:i,defaultProps:d,toAttributeName:r=P,toAttributeValue:u=k}){const h=Number.parseInt(t.version)>=19,p=t.forwardRef((g,f)=>{var w,_;const l=t.useRef(null),T=t.useRef(new Map),E={},R={},m={},y={};for(const[a,s]of Object.entries(g)){if(H.has(a)){m[a]=s;continue}const c=r(F[a]??a);if(n.prototype&&a in n.prototype&&!(a in(((w=globalThis.HTMLElement)==null?void 0:w.prototype)??{}))&&!((_=n.observedAttributes)!=null&&_.some(v=>v===c))){y[a]=s;continue}if(a.startsWith("on")){E[a]=s;continue}const b=u(s);if(c&&b!=null&&(R[c]=String(b),h||(m[c]=b)),c&&h){const v=k(s);b!==v?m[c]=b:m[c]=s}}if(typeof window<"u"){for(const a in E){const s=E[a],c=a.endsWith("Capture"),b=(o?.[a]??a.slice(2).toLowerCase()).slice(0,c?-7:void 0);t.useLayoutEffect(()=>{const v=l?.current;if(!(!v||typeof s!="function"))return v.addEventListener(b,s,c),()=>{v.removeEventListener(b,s,c)}},[l?.current,s])}t.useLayoutEffect(()=>{if(l.current===null)return;const a=new Map;for(const s in y)L(l.current,s,y[s]),T.current.delete(s),a.set(s,y[s]);for(const[s,c]of T.current)L(l.current,s,void 0);T.current=a})}if(typeof window>"u"&&n?.getTemplateHTML&&n?.shadowRootOptions){const{mode:a,delegatesFocus:s}=n.shadowRootOptions,c=t.createElement("template",{shadowrootmode:a,shadowrootdelegatesfocus:s,dangerouslySetInnerHTML:{__html:n.getTemplateHTML(R,g)},key:"ce-la-react-ssr-template-shadow-root"});m.children=[c,m.children]}return t.createElement(e,{...d,...m,ref:t.useCallback(a=>{l.current=a,typeof f=="function"?f(a):f!==null&&(f.current=a)},[f])},m.children)});return p.displayName=i??n.name,p}function L(t,e,n){var o;t[e]=n,n==null&&e in(((o=globalThis.HTMLElement)==null?void 0:o.prototype)??{})&&t.removeAttribute(e)}var V=W({react:N,tagName:"dash-video",elementClass:B,toAttributeName(t){return t==="muted"?"":t==="defaultMuted"?"muted":P(t)}});export{V as default};
//# sourceMappingURL=react-DrKusr7w.js.map
